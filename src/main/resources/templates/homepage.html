

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home Page</title>
    <link rel="stylesheet" th:href="@{/css/homepagestyle.css}" />
</head>
<body>

<header>
    <h1>Welcome to Blog Page</h1>
    <nav>
        <a th:href="@{/homepage}">Home</a>
        <a sec:authorize="isAuthenticated()" th:href="@{/create-post}">Create Post</a>
        <a sec:authorize="!isAuthenticated()" th:href="@{/showLoginPage}">Login</a>
        <a sec:authorize="isAuthenticated()" th:href="@{/logout}">Logout</a>
    </nav>
</header>

<div class="search-row">
    <form class="search-form" th:action="@{/search}" method="get">
        <input type="text" placeholder="Search..." name="search"/>
        <input type="submit" value="Search"/>
    </form>
</div>

<form class="filters-form" th:action="@{/search}" method="get">
    <div class="filter-block">
        <div class="filter-label">Authors</div>
        <div class="filter-options">
            <label th:each="author : ${authors}">
                <input type="checkbox" name="author" th:value="${author}" th:id="${author}" />
                <span th:text="${author}"></span>
            </label>
        </div>
    </div>

    <div class="filter-block">
        <div class="filter-label">Tags</div>
        <div class="filter-options">
            <label th:each="tag : ${tags}">
                <input type="checkbox" name="tag" th:value="${tag}" th:id="${tag}" />
                <span th:text="${tag}"></span>
            </label>
        </div>
    </div>

    <div class="filter-block">
        <div class="filter-label">Published Dates</div>
        <div class="filter-options">
            <label th:each="date : ${dates}">
                <input type="checkbox" name="publishedDate" th:value="${date}" th:id="${date}" />
                <span th:text="${date}"></span>
            </label>
        </div>
    </div>

    <div class="filter-block">
        <div class="filter-label">Sort</div>
        <select name="sort">
            <option value="desc">Newest First</option>
            <option value="asc">Oldest First</option>
        </select>
        <input type="submit" value="Apply" />
    </div>
</form>

<div class="container" th:if="${posts}">
    <div th:each="post : ${posts}" class="post-box">
        <div class="post-title" th:text="${post.title}"></div>
        <div class="post-meta-row">
            <span th:text="${post.authorUser != null ? post.authorUser.name : 'Unknown Author'}"></span>
            <span th:if="${post.publishedDate != null}">, <span th:text="${post.publishedDate}"></span></span>
        </div>

        <div class="post-excerpt" th:text="${post.excerpt}"></div>
        <div class="post-content" th:utext="${post.content}"></div>


        <div class="tags">
            <span th:each="tag : ${post.tags}" class="tag" th:text="${tag.name}"></span>
        </div>
        <div class="read-more-row">
            <a th:href="@{'/view-post/' + ${post.postId}}" class="read-more-link">Read More</a>
        </div>
    </div>
</div>

<footer>
    <nav>
        <ul class="pagination-simple">
            <li th:classappend="${currentPage == 0} ? 'disabled'">
                <span th:if="${currentPage == 0}">Prev</span>
                <a th:if="${currentPage > 0}" th:href="@{/homepage(page=${currentPage -1},
                 size=${pageSize})}">Prev</a>
            </li>
            <li th:classappend="${currentPage + 1 >= totalPages} ? 'disabled'">
                <span th:if="${currentPage + 1 >= totalPages}">Next</span>
                <a th:if="${currentPage + 1 < totalPages}" th:href="@{/homepage(page=${currentPage+1},
                 size=${pageSize})}">Next</a>
            </li>
        </ul>
    </nav>
</footer>

</body>
</html>
