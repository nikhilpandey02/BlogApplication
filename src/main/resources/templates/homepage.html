<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home Page</title>
    <link rel="stylesheet" th:href="@{/css/homepagestyle.css}" />
    <style>
        .dropdown-checkbox {
            position: relative;
            width: 220px;
            user-select: none;
            display: inline-block;
            margin-right: 15px;
        }
        .dropdown-checkbox input.toggle {
            display: none;
        }
        .dropdown-checkbox-label {
            display: block;
            padding: 10px;
            border: 1px solid #000;
            border-radius: 5px;
            background: #fff;
            cursor: pointer;
            font-weight: 600;
            color: #000;
            position: relative;
        }
        .dropdown-checkbox-label::after {
            content: "â–¼";
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7em;
            color: #000;
        }
        .dropdown-checkbox-panel {
            display: none;
            position: absolute;
            z-index: 1000;
            width: 100%;
            max-height: 160px;
            overflow-y: auto;
            background: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            margin-top: 3px;
            border: 1px solid #000;
            border-radius: 5px;
            padding: 8px 12px;
            box-sizing: border-box;
        }
        .dropdown-checkbox input.toggle:checked ~ .dropdown-checkbox-panel {
            display: block;
        }
        .dropdown-checkbox-panel label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 4px 0;
            font-size: 0.9rem;
            color: #000;
        }
        .dropdown-checkbox-panel label:hover {
            background-color: #f0f0f0;
        }
        .dropdown-checkbox-panel input[type="checkbox"] {
            margin-right: 8px;
        }
    </style>

</head>
<body>
<h1>Welcome to Blog Page</h1>

<!-- Search bar at top, right-aligned -->
<div class="search-row">
    <form class="search-form" th:action="@{/search}" method="get">
        <input type="text" placeholder="Search..." name="search"/>
        <input type="submit" value="Search"/>
    </form>
</div>

<!-- Filters in a separate bar below -->
<form class="filters-form" th:action="@{/search}" method="get">

    <div class="dropdown-checkbox">
        <input type="checkbox" class="toggle" id="toggleAuthors" />
        <label for="toggleAuthors" class="dropdown-checkbox-label">Select Authors</label>
        <div class="dropdown-checkbox-panel">
            <label th:each="author : ${authors}">
                <input type="checkbox" name="author" th:value="${author}" />
                <span th:text="${author}"></span>
            </label>
        </div>
    </div>

    <div class="dropdown-checkbox">
        <input type="checkbox" class="toggle" id="toggleDates" />
        <label for="toggleDates" class="dropdown-checkbox-label">Select Published Dates</label>
        <div class="dropdown-checkbox-panel">
            <label th:each="date : ${dates}">
                <input type="checkbox" name="publishedDate" th:value="${date}" />
                <span th:text="${date}"></span>
            </label>
        </div>
    </div>

    <div class="dropdown-checkbox">
        <input type="checkbox" class="toggle" id="toggleTags" />
        <label for="toggleTags" class="dropdown-checkbox-label">Select Tags</label>
        <div class="dropdown-checkbox-panel">
            <label th:each="tag : ${tags}">
                <input type="checkbox" name="tag" th:value="${tag}" />
                <span th:text="${tag}"></span>
            </label>
        </div>
    </div>
    <select name="sortBy">
        <option value="desc">Newest First</option>
        <option value="asc">Oldest First</option>
    </select>
    <input type="submit" value="Apply" />
</form>

<!-- Post cards -->
<div th:if="${posts}" class="container">
    <div th:each="post : ${posts}" class="post-box">
        <div class="post-title" th:text="${post.title}"></div>
        <div class="post-meta-row">
            <span th:text="${post.author}"></span><span th:text="', ' + ${post.publishedDate}"></span>
        </div>
        <div class="post-excerpt" th:text="${post.excerpt}"></div>
        <div class="post-content" th:text="${post.content}"></div>
        <div class="tags">
            <span th:each="tag : ${post.tags}" class="tag" th:text="${tag.name}"></span>
        </div>
        <div class="read-more-row">
            <a th:href="@{'/view-post/' + ${post.postId}}" class="read-more-link">Read More</a>
        </div>
    </div>
</div>
<footer>
    <nav>
        <ul class="pagination-simple">
            <li th:classappend="${currentPage == 0} ? 'disabled'">
                <a th:href="@{/homepage(page=${currentPage > 0 ? currentPage - 1 : 0}, size=${pageSize})}">Prev</a>
            </li>
            <li th:classappend="${(currentPage ?: 0) + 1 >= (totalPages ?: 1)} ? 'disabled' : ''">
                <a th:href="@{/homepage(page=${(currentPage ?: 0) + 1 < (totalPages ?: 1) ? (currentPage ?: 0) + 1 : (currentPage ?: 0)}, size=${pageSize})}"
                >Next</a>
            </li>
        </ul>
    </nav>
</footer>




</body>
</html>
